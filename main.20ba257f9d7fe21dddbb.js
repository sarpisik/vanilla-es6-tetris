(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"9d8Q":function(e,t,r){},p2bk:function(e,t,r){},tjUo:function(e,t,r){"use strict";r.r(t);var n="TJLOSZI",a=function(){return function(e){switch(e){case"I":return[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]];case"L":return[[0,2,0],[0,2,0],[0,2,2]];case"J":return[[0,3,0],[0,3,0],[3,3,0]];case"O":return[[4,4],[4,4]];case"Z":return[[5,5,0],[0,5,5],[0,0,0]];case"S":return[[0,6,6],[6,6,0],[0,0,0]];default:return[[0,7,0],[7,7,7],[0,0,0]]}}(n[n.length*Math.random()|0])};function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"reset",function(e){t.matrix=a(),t.pos.y=0,t.pos.x=(e[0].length/2|0)-(t.matrix[0].length/2|0)}),i(this,"clear",function(){t.score=0,t.level=0,t.clearedRows=0}),this.pos={x:0,y:0},this.matrix=null,this.score=0,this.clearedRows=0,this.level=0};var l=function e(t){var r,n,a,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a=function(e){return i.element.innerText=e},(n="updateContent")in(r=this)?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a,this.element=document.querySelector(t)};function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function e(t,r){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"createMatrix",function(){for(var e=[];l.rows--;)e.push(new Array(l.columns).fill(0));return e}),s(this,"draw",function(e){l.context.fillStyle="#000",l.context.fillRect(0,0,l.canvas.width,l.canvas.height),l.drawMatrix(l.matrix,{x:0,y:0}),l.drawMatrix(e.matrix,e.pos)}),s(this,"drawMatrix",function(e,i){var o=l;e.forEach(function(e,a){e.forEach(function(e,t){if(0!==e){var r=l.colors[e];o.context.fillStyle="rgba(".concat(r,", 0.8)"),o.context.fillRect(t+i.x,a+i.y,1,1);var n=o.context.createLinearGradient(0,0,1,1);n.addColorStop("0","rgba(".concat(r,", 0.3)")),n.addColorStop("1.0","rgba(".concat(r,", 1)")),o.context.strokeStyle=n,o.context.lineWidth=.1,o.context.strokeRect(t+i.x,a+i.y,1,1)}})})}),s(this,"sweep",function(){self=l;var e=0,t=0;e:for(var r=self.matrix.length-1;0<r;--r){for(var n=0;n<self.matrix[r].length;++n)if(0===self.matrix[r][n])continue e;var a=self.matrix.splice(r,1)[0].fill(0);self.matrix.unshift(a),++r,t+=10*++e}return[e,t]}),this.canvas=document.getElementById("tetris"),this.context=this.canvas.getContext("2d"),this.context.scale(20,20),this.columns=t,this.rows=r,this.matrix=this.createMatrix(),this.colors=[null,"255, 13, 114","13, 194, 255","13, 255, 114","245, 56, 255","255, 142, 13","255, 225, 56","56, 119, 255"]};var u=function e(t,r){var n,a,i,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=function(e){return o.element.innerText=e},(a="updateContent")in(n=this)?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i,this.element=document.querySelector(t),this.element.addEventListener("click",r)};function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r("9d8Q"),r("p2bk");new function e(){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"initialGameSettings",function(){a.player=new o,a.lastTime=0,a.dropCounter=0,a.player.reset(a.arena.matrix)}),d(this,"handleStartButtonClick",function(e){if("Reset Game"===e.target.innerText)return a.resetGame();a.startButton.updateContent("Reset Game"),a.renderGame()}),d(this,"renderGame",function(){a.gameOver=!1,a.dropInterval=1e3,a.arena.matrix.forEach(function(e){return e.fill(0)}),a.player.clear(),a.updateBoard(),a.update()}),d(this,"resetGame",function(){a.gameOver=!0,a.initialGameSettings(),a.renderGame()}),d(this,"update",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=e-a.lastTime;a.dropCounter+=t,a.dropCounter>a.dropInterval&&a.dropPlayer(),a.lastTime=e,a.drawBoard(),a.gameOver||window.requestAnimationFrame(a.update)}),d(this,"dropPlayer",function(){if(a.player.pos.y++,a.isCollided(a.arena.matrix,a.player)){a.player.pos.y--,a.merge(a.arena.matrix,a.player),a.resetPlayer();var e=f(a.arena.sweep(a.player.score),2),t=e[0],r=e[1];0<t&&a.updateLevel(t,r),a.updateBoard()}a.dropCounter=0}),d(this,"isCollided",function(e,t){for(var r=t.pos,n=t.matrix,a=0;a<n.length;++a)for(var i=0;i<n[a].length;++i)if(0!==n[a][i]&&0!==(e[a+r.y]&&e[a+r.y][i+r.x]))return!0;return!1}),d(this,"merge",function(n,e){var a=e.pos;e.matrix.forEach(function(e,r){e.forEach(function(e,t){0!==e&&(n[r+a.y][t+a.x]=e)})})}),d(this,"resetPlayer",function(){a.player.reset(a.arena.matrix),a.isCollided(a.arena.matrix,a.player)&&a.onGameOver()}),d(this,"onGameOver",function(){a.gameOver=!0,a.startButton.updateContent("Restart Game")}),d(this,"updateBoard",function(){a.scoreBoard.updateContent(a.player.score),a.levelBoard.updateContent(a.player.level),a.clearedRowsBoard.updateContent(a.player.clearedRows)}),d(this,"updateLevel",function(e,t){var r=a;r.player.clearedRows+=e,r.player.score+=t,r.player.clearedRows>=5*(r.player.level+1)&&(r.player.level++,r.dropInterval=r.dropInterval/(r.player.level+1)+200)}),d(this,"drawBoard",function(){return a.arena.draw(a.player)}),d(this,"handleKeyDown",function(e){var t=e.keyCode;37===t?a.playerMove(-1):39===t?a.playerMove(1):40===t?a.dropPlayer():81===t?a.playerRotate(-1):87===t&&a.playerRotate(1)}),d(this,"handleMoveOnClick",function(e){switch(e.target.alt){case"left arrow":return a.playerMove(-1);case"right arrow":return a.playerMove(1);case"dash":return a.dropPlayer();default:return a.playerRotate(1)}}),d(this,"playerMove",function(e){a.player.pos.x+=e,a.isCollided(a.arena.matrix,a.player)&&(a.player.pos.x-=e)}),d(this,"playerRotate",function(e){var t=a,r=t.player.pos.x,n=1;for(t.rotate(t.player.matrix,e);t.isCollided(t.arena.matrix,t.player);)if(t.player.pos.x+=n,(n=-(n+(0<n?1:-1)))>t.player.matrix[0].length)return t.rotate(t.player.matrix,-e),void(t.player.pos.x=r)}),d(this,"rotate",function(e,t){for(var r=0;r<e.length;++r)for(var n=0;n<r;++n){var a=[e[r][n],e[n][r]];e[n][r]=a[0],e[r][n]=a[1]}0<t?e.forEach(function(e){return e.reverse()}):e.reverse()}),this.scoreBoard=new l("#score"),this.levelBoard=new l("#level"),this.clearedRowsBoard=new l("#clearedRows"),this.arena=new c(12,20),this.startButton=new u("#start",this.handleStartButtonClick),this.moveLeftButton=new u("#moveLeft",this.handleMoveOnClick),this.moveRightButton=new u("#moveRight",this.handleMoveOnClick),this.dashButton=new u("#dash",this.handleMoveOnClick),this.rotateButton=new u("#rotate",this.handleMoveOnClick),document.addEventListener("keydown",this.handleKeyDown),this.initialGameSettings(),this.updateBoard()},"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/service-worker.js").then(function(e){console.log("SW registered: ",e)}).catch(function(e){console.log("SW registration failed: ",e)})})}},[["tjUo",1]]]);