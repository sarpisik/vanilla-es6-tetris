(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"9d8Q":function(e,t,r){},ZhF4:function(e,t,r){e.exports=r.p+"images/43785803455d69b93657068bbe08a45e.png"},p2bk:function(e,t,r){},sh1U:function(e,t,r){e.exports=r.p+"images/e7e65bacea32b450c5417b58c41fe8fe.png"},tjUo:function(e,t,r){"use strict";r.r(t);var a="TJLOSZI",n=function(){return function(e){switch(e){case"I":return[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]];case"L":return[[0,2,0],[0,2,0],[0,2,2]];case"J":return[[0,3,0],[0,3,0],[3,3,0]];case"O":return[[4,4],[4,4]];case"Z":return[[5,5,0],[0,5,5],[0,0,0]];case"S":return[[0,6,6],[6,6,0],[0,0,0]];default:return[[0,7,0],[7,7,7],[0,0,0]]}}(a[a.length*Math.random()|0])};function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"reset",function(e){t.matrix=t.matrixes[0],t.nextMatrix=t.matrixes[1],t.pos.y=0,t.pos.x=(e[0].length/2|0)-(t.matrix[0].length/2|0),t.matrixes.push(n()),t.matrixes.shift()}),o(this,"clear",function(){t.score=0,t.level=0,t.clearedRows=0}),this.pos={x:0,y:0},this.matrixes=[n(),n()],this.score=0,this.clearedRows=0,this.level=0};var l=function e(t){var r,a,n,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(e){return o.element.innerText=e},(a="updateContent")in(r=this)?Object.defineProperty(r,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[a]=n,this.element=document.querySelector(t)};function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function e(t,r,a){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"createMatrix",function(){for(var e=[];l.rows--;)e.push(new Array(l.columns).fill(0));return e}),i(this,"draw",function(e){l.context.fillStyle="#000",l.context.fillRect(0,0,l.canvas.width,l.canvas.height),l.drawMatrix(l.matrix,{x:0,y:0}),l.drawMatrix(e.matrix,e.pos,!0)}),i(this,"drawMatrix",function(e,o){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],s=l;e.forEach(function(e,n){e.forEach(function(e,t){if(0!==e){var r=i?l.colors[e]:l.mergedItemColor;s.context.fillStyle="rgba(".concat(r,", 0.8)"),s.context.fillRect(t+o.x,n+o.y,1,1);var a=s.context.createLinearGradient(0,0,1,1);a.addColorStop("0","rgba(".concat(r,", 0.3)")),a.addColorStop("1.0","rgba(".concat(r,", 1)")),s.context.strokeStyle=a,s.context.lineWidth=.1,s.context.strokeRect(t+o.x,n+o.y,1,1)}})})}),i(this,"sweep",function(){self=l;var e=0,t=0;e:for(var r=self.matrix.length-1;0<r;--r){for(var a=0;a<self.matrix[r].length;++a)if(0===self.matrix[r][a])continue e;var n=self.matrix.splice(r,1)[0].fill(0);self.matrix.unshift(n),++r,t+=10*++e}return[e,t]}),this.canvas=document.getElementById("tetris"),this.context=this.canvas.getContext("2d"),this.context.scale(20,20),this.columns=t,this.rows=r,this.matrix=this.createMatrix(),this.colors=a,this.mergedItemColor="198,177,199"};var u=function e(t,r){var a,n,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(e){return i.element.innerText=e},(n="updateContent")in(a=this)?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o,this.element=document.querySelector(t),this.element.addEventListener("click",r)},h=r("ZhF4"),f=r.n(h),d=r("sh1U"),p=r.n(d);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y="32, 32, 40",g=function e(t){var r,a,n=this;m(this,e),v(this,"drawNextItem",function(e){var o=n;o.resetBackground(),e.forEach(function(e,n){n>=o.cellLimit||e.forEach(function(e,t){if(!(t>=o.cellLimit)){var r=o.squares[n][t],a=0<e?o.colors[e]:y;r.changeBackgroundColor(a)}})})}),v(this,"resetBackground",function(){return n.squares.forEach(x)}),this.element=document.querySelector(".next-item"),this.squares=(r=this.element,(a=[[],[],[]]).map(function(e){for(var t=0;t<3;t++)e.push(new w(r))}),a),this.colors=t,this.cellLimit=3},w=function e(t){var r=this;m(this,e),v(this,"changeBackgroundColor",function(e){return r.element.style.backgroundColor="rgb(".concat(e,")")}),this.element=document.createElement("div"),t.appendChild(this.element)};function x(e){e.forEach(function(e){return e.changeBackgroundColor(y)})}var b=function(e,t){for(var r=t.pos,a=t.matrix,n=0;n<a.length;++n)for(var o=0;o<a[n].length;++o)if(0!==a[n][o]&&0!==(e[n+r.y]&&e[n+r.y][o+r.x]))return!0;return!1},C=function(e,t){for(var r=0;r<e.length;++r)for(var a=0;a<r;++a){var n=[e[r][a],e[a][r]];e[a][r]=n[0],e[r][a]=n[1]}0<t?e.forEach(function(e){return e.reverse()}):e.reverse()},B=[null,"255, 13, 114","13, 194, 255","13, 255, 114","245, 56, 255","255, 142, 13","255, 225, 56","56, 119, 255"];function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],a=!0,n=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);a=!0);}catch(e){n=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(n)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r("9d8Q"),r("p2bk");new function e(){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),I(this,"initialGameSettings",function(){i.player=new s,i.lastTime=0,i.dropCounter=0,i.gameOver=!0,i.dashPlayer=!1,i.player.reset(i.arena.matrix)}),I(this,"handleStartButtonClick",function(e){var t=e.currentTarget.dataset,r=e.target;if(i.gameOver)return t.state="pause",r.src=p.a,i.renderGame();"play"===t.state?(i.gamePause=!1,t.state="pause",r.src=p.a,i.update()):(i.gamePause=!0,t.state="play",r.src=f.a)}),I(this,"renderGame",function(){i.gameOver=!1,i.gamePause=!1,i.dropInterval=700,i.dashSpeed=10,i.arena.matrix.forEach(function(e){return e.fill(0)}),i.player.clear(),i.updateBoard(),i.nextItemBoard.drawNextItem(i.player.nextMatrix),i.update()}),I(this,"resetGame",function(){i.gameOver=!0,i.initialGameSettings(),i.startButton.element.dataset.state="pause",i.controlIcon.src=p.a,i.renderGame()}),I(this,"update",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=e-i.lastTime;i.dropCounter+=t,i.dropSpeed=i.dashPlayer?i.dashSpeed:i.dropInterval,i.dropCounter>i.dropSpeed&&i.dropPlayer(),i.lastTime=e,i.drawBoard(),i.gameOver||i.gamePause||window.requestAnimationFrame(i.update)}),I(this,"dropPlayer",function(){if(i.player.pos.y++,b(i.arena.matrix,i.player)){i.player.pos.y--,a=i.arena.matrix,n=i.player,o=n.pos,n.matrix.forEach(function(e,r){e.forEach(function(e,t){0!==e&&(a[r+o.y][t+o.x]=e)})}),i.resetPlayer();var e=k(i.arena.sweep(i.player.score),2),t=e[0],r=e[1];0<t&&i.updateLevel(t,r),i.dashPlayer&&i.toggleDashItem(),i.nextItemBoard.drawNextItem(i.player.nextMatrix),i.updateBoard()}var a,n,o;i.dropCounter=0}),I(this,"resetPlayer",function(){i.player.reset(i.arena.matrix),b(i.arena.matrix,i.player)&&i.onGameOver()}),I(this,"onGameOver",function(){i.gameOver=!0,i.controlIcon.src=f.a}),I(this,"updateBoard",function(){i.scoreBoard.updateContent(i.player.score),i.clearedRowsBoard.updateContent(i.player.clearedRows)}),I(this,"updateLevel",function(e,t){var r=i;r.player.clearedRows+=e,r.player.score+=t,r.player.clearedRows>=5*(r.player.level+1)&&(r.player.level++,r.dropInterval=r.dropInterval/(r.player.level+1)+200)}),I(this,"drawBoard",function(){return i.arena.draw(i.player)}),I(this,"handleKeyDown",function(e){var t=e.keyCode;i.gamePause||(37===t?i.playerMove(-1):39===t?i.playerMove(1):40===t?i.toggleDashItem():81===t?i.playerRotate(-1):87===t&&i.playerRotate(1))}),I(this,"handleMoveOnClick",function(e){var t=e.target.alt;if(!i.gamePause)return"left arrow"===t?i.playerMove(-1):"right arrow"===t?i.playerMove(1):"dash"===t?i.toggleDashItem():"rotate"===t?i.playerRotate(1):void 0}),I(this,"playerMove",function(e){i.player.pos.x+=e,b(i.arena.matrix,i.player)&&(i.player.pos.x-=e)}),I(this,"playerRotate",function(e){var t=i,r=t.player.pos.x,a=1;for(C(t.player.matrix,e);t.isCollided(t.arena.matrix,t.player);)if(t.player.pos.x+=a,(a=-(a+(0<a?1:-1)))>t.player.matrix[0].length)return C(t.player.matrix,-e),void(t.player.pos.x=r)}),I(this,"toggleDashItem",function(){return i.dashPlayer=!i.dashPlayer}),this.colors=B,this.scoreBoard=new l("#score"),this.clearedRowsBoard=new l("#clearedRows"),this.nextItemBoard=new g(this.colors),this.startButton=new u("#control",this.handleStartButtonClick),this.restartButton=new u("#restart",this.resetGame),this.controlIcon=document.querySelector(".control-icon"),this.moveLeftButton=new u("#moveLeft",this.handleMoveOnClick),this.moveRightButton=new u("#moveRight",this.handleMoveOnClick),this.dashButton=new u("#dash",this.handleMoveOnClick),this.rotateButton=new u("#rotate",this.handleMoveOnClick),this.arena=new c(12,20,this.colors),document.addEventListener("keydown",this.handleKeyDown),this.initialGameSettings(),this.updateBoard()},"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/vanilla-es6-tetris/service-worker.js").then(function(e){console.log("SW registered: ",e)}).catch(function(e){console.log("SW registration failed: ",e)})})}},[["tjUo",1]]]);