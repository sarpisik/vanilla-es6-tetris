(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"9d8Q":function(e,t,r){},ZhF4:function(e,t,r){e.exports=r.p+"images/43785803455d69b93657068bbe08a45e.png"},p2bk:function(e,t,r){},sh1U:function(e,t,r){e.exports=r.p+"images/e7e65bacea32b450c5417b58c41fe8fe.png"},tjUo:function(e,t,r){"use strict";r.r(t);var n="TJLOSZI",a=function(){return function(e){switch(e){case"I":return[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]];case"L":return[[0,2,0],[0,2,0],[0,2,2]];case"J":return[[0,3,0],[0,3,0],[3,3,0]];case"O":return[[4,4],[4,4]];case"Z":return[[5,5,0],[0,5,5],[0,0,0]];case"S":return[[0,6,6],[6,6,0],[0,0,0]];default:return[[0,7,0],[7,7,7],[0,0,0]]}}(n[n.length*Math.random()|0])};function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o(this,"reset",function(e){t.matrix=t.matrixes[0],t.nextMatrix=t.matrixes[1],t.pos.y=0,t.pos.x=(e[0].length/2|0)-(t.matrix[0].length/2|0),t.matrixes.push(a()),t.matrixes.shift()}),o(this,"clear",function(){t.score=0,t.level=0,t.clearedRows=0}),this.pos={x:0,y:0},this.matrixes=[a(),a()],this.score=0,this.clearedRows=0,this.level=0};var s=function e(t){var r,n,a,o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a=function(e){return o.element.innerText=e},(n="updateContent")in(r=this)?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a,this.element=document.querySelector(t)};function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function e(t,r,n){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"createMatrix",function(){for(var e=[];s.rows--;)e.push(new Array(s.columns).fill(0));return e}),l(this,"draw",function(e){s.context.fillStyle="#000",s.context.fillRect(0,0,s.canvas.width,s.canvas.height),s.drawMatrix(s.matrix,{x:0,y:0}),s.drawMatrix(e.matrix,e.pos)}),l(this,"drawMatrix",function(e,o){var i=s;e.forEach(function(e,a){e.forEach(function(e,t){if(0!==e){var r=s.colors[e];i.context.fillStyle="rgba(".concat(r,", 0.8)"),i.context.fillRect(t+o.x,a+o.y,1,1);var n=i.context.createLinearGradient(0,0,1,1);n.addColorStop("0","rgba(".concat(r,", 0.3)")),n.addColorStop("1.0","rgba(".concat(r,", 1)")),i.context.strokeStyle=n,i.context.lineWidth=.1,i.context.strokeRect(t+o.x,a+o.y,1,1)}})})}),l(this,"sweep",function(){self=s;var e=0,t=0;e:for(var r=self.matrix.length-1;0<r;--r){for(var n=0;n<self.matrix[r].length;++n)if(0===self.matrix[r][n])continue e;var a=self.matrix.splice(r,1)[0].fill(0);self.matrix.unshift(a),++r,t+=10*++e}return[e,t]}),this.canvas=document.getElementById("tetris"),this.context=this.canvas.getContext("2d"),this.context.scale(20,20),this.columns=t,this.rows=r,this.matrix=this.createMatrix(),this.colors=n};var u=function e(t,r){var n,a,o,i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(e){return i.element.innerText=e},(a="updateContent")in(n=this)?Object.defineProperty(n,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[a]=o,this.element=document.querySelector(t),this.element.addEventListener("click",r)},h=r("ZhF4"),f=r.n(h),d=r("sh1U"),p=r.n(d);function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function e(t){var r,n,a=this;m(this,e),v(this,"drawNextItem",function(e){var o=a;o.resetBackground(),e.forEach(function(e,a){a>=o.cellLimit||e.forEach(function(e,t){if(!(t>=o.cellLimit)){var r=o.squares[a][t],n=0<e?o.colors[e]:"0,0,0";r.changeBackgroundColor(n)}})})}),v(this,"resetBackground",function(){return a.squares.forEach(x)}),this.element=document.querySelector(".next-item"),this.squares=(r=this.element,(n=[[],[],[]]).map(function(e){for(var t=0;t<3;t++)e.push(new w(r))}),n),this.colors=t,this.cellLimit=3},w=function e(t){var r=this;m(this,e),v(this,"changeBackgroundColor",function(e){return r.element.style.backgroundColor="rgb(".concat(e,")")}),this.element=document.createElement("div"),t.appendChild(this.element)};function x(e){e.forEach(function(e){return e.changeBackgroundColor("0,0,0")})}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r("9d8Q"),r("p2bk");new function e(){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),b(this,"initialGameSettings",function(){a.player=new i,a.lastTime=0,a.dropCounter=0,a.player.reset(a.arena.matrix)}),b(this,"handleStartButtonClick",function(e){var t=e.currentTarget.dataset,r=e.target;if(a.gameOver)return t.state="pause",r.src=p.a,a.renderGame();"play"===t.state?(a.gamePause=!1,t.state="pause",r.src=p.a,a.update()):(a.gamePause=!0,t.state="play",r.src=f.a)}),b(this,"renderGame",function(){a.gameOver=!1,a.gamePause=!1,a.dropInterval=1e3,a.arena.matrix.forEach(function(e){return e.fill(0)}),a.player.clear(),a.updateBoard(),a.nextItemBoard.drawNextItem(a.player.nextMatrix),a.update()}),b(this,"resetGame",function(){a.gameOver=!0,a.initialGameSettings(),a.startButton.element.dataset.state="pause",a.controlIcon.src=p.a,a.renderGame()}),b(this,"update",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=e-a.lastTime;a.dropCounter+=t,a.dropCounter>a.dropInterval&&a.dropPlayer(),a.lastTime=e,a.drawBoard(),a.gameOver||a.gamePause||window.requestAnimationFrame(a.update)}),b(this,"dropPlayer",function(){if(a.player.pos.y++,a.isCollided(a.arena.matrix,a.player)){a.player.pos.y--,a.merge(a.arena.matrix,a.player),a.resetPlayer();var e=g(a.arena.sweep(a.player.score),2),t=e[0],r=e[1];0<t&&a.updateLevel(t,r),a.nextItemBoard.drawNextItem(a.player.nextMatrix),a.updateBoard()}a.dropCounter=0}),b(this,"isCollided",function(e,t){for(var r=t.pos,n=t.matrix,a=0;a<n.length;++a)for(var o=0;o<n[a].length;++o)if(0!==n[a][o]&&0!==(e[a+r.y]&&e[a+r.y][o+r.x]))return!0;return!1}),b(this,"merge",function(n,e){var a=e.pos;e.matrix.forEach(function(e,r){e.forEach(function(e,t){0!==e&&(n[r+a.y][t+a.x]=e)})})}),b(this,"resetPlayer",function(){a.player.reset(a.arena.matrix),a.isCollided(a.arena.matrix,a.player)&&a.onGameOver()}),b(this,"onGameOver",function(){a.gameOver=!0,a.controlIcon.src=f.a}),b(this,"updateBoard",function(){a.scoreBoard.updateContent(a.player.score),a.clearedRowsBoard.updateContent(a.player.clearedRows)}),b(this,"updateLevel",function(e,t){var r=a;r.player.clearedRows+=e,r.player.score+=t,r.player.clearedRows>=5*(r.player.level+1)&&(r.player.level++,r.dropInterval=r.dropInterval/(r.player.level+1)+200)}),b(this,"drawBoard",function(){return a.arena.draw(a.player)}),b(this,"handleKeyDown",function(e){var t=e.keyCode;a.gamePause||(37===t?a.playerMove(-1):39===t?a.playerMove(1):40===t?a.dropPlayer():81===t?a.playerRotate(-1):87===t&&a.playerRotate(1))}),b(this,"handleMoveOnClick",function(e){var t=e.target.alt;if(!a.gamePause)return"left arrow"===t?a.playerMove(-1):"right arrow"===t?a.playerMove(1):"dash"===t?a.dropPlayer():"rotate"===t?a.playerRotate(1):void 0}),b(this,"playerMove",function(e){a.player.pos.x+=e,a.isCollided(a.arena.matrix,a.player)&&(a.player.pos.x-=e)}),b(this,"playerRotate",function(e){var t=a,r=t.player.pos.x,n=1;for(t.rotate(t.player.matrix,e);t.isCollided(t.arena.matrix,t.player);)if(t.player.pos.x+=n,(n=-(n+(0<n?1:-1)))>t.player.matrix[0].length)return t.rotate(t.player.matrix,-e),void(t.player.pos.x=r)}),b(this,"rotate",function(e,t){for(var r=0;r<e.length;++r)for(var n=0;n<r;++n){var a=[e[r][n],e[n][r]];e[n][r]=a[0],e[r][n]=a[1]}0<t?e.forEach(function(e){return e.reverse()}):e.reverse()}),this.colors=[null,"255, 13, 114","13, 194, 255","13, 255, 114","245, 56, 255","255, 142, 13","255, 225, 56","56, 119, 255"],this.scoreBoard=new s("#score"),this.clearedRowsBoard=new s("#clearedRows"),this.nextItemBoard=new y(this.colors),this.startButton=new u("#control",this.handleStartButtonClick),this.restartButton=new u("#restart",this.resetGame),this.controlIcon=document.querySelector(".control-icon"),this.moveLeftButton=new u("#moveLeft",this.handleMoveOnClick),this.moveRightButton=new u("#moveRight",this.handleMoveOnClick),this.dashButton=new u("#dash",this.handleMoveOnClick),this.rotateButton=new u("#rotate",this.handleMoveOnClick),this.arena=new c(12,20,this.colors),document.addEventListener("keydown",this.handleKeyDown),this.gameOver=!0,this.initialGameSettings(),this.updateBoard()},"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/vanilla-es6-tetris/service-worker.js").then(function(e){console.log("SW registered: ",e)}).catch(function(e){console.log("SW registration failed: ",e)})})}},[["tjUo",1]]]);